<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feliz Dia do Engenheiro Eletricista!</title>
    <!-- Importa a fonte usada no CSS original -->
    <link rel="icon" type="image/png" href="storm.png">
    <link href="https://fonts.googleapis.com/css?family=Patrick+Hand" rel="stylesheet">
    <style>
        /* Seu CSS original, com pequenos ajustes */
        body {
            background: black;
            font-family: 'Patrick Hand', cursive;
            /* Adicionado para centralizar a lâmpada */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden; /* Evita barras de rolagem */
        }

        .container {
            position: relative;
            width: 400px;
            height: 400px;
            top: 0;
            z-index: 1; /* NOVO: Garante que a lâmpada fique atrás dos overlays */
            /* Removido 'margin: 0 50%' que estava empurrando para fora da tela */
        }

        .interruptor {
            background-color: #ff5050;
            position: absolute;
            height: 450px; /* Alterado de 350px */
            border: 2px dotted white;
            right: 30%;
            top: -230px; /* Alterado de -130px */
            z-index: 9999;
            /* cursor: pointer;  REMOVIDO DAQUI */
        }

        .botao {
            position: absolute;
            left: -20px;
            bottom: -25px;
            border-radius: 70% 50% 50% 70%;
            border-top: 4px solid #ff5050;
            box-sizing: border-box;
            border-left: 20px solid #ff5050;
            border-right: 20px solid #ff5050;
            border-bottom: 7px solid #ff5050;
            transform: rotate(90deg);
            cursor: pointer; /* ADICIONADO AQUI */
        }

        .botao::after {
            position: absolute;
            content: attr(data-text); /* Alterado de "Puxe-me!" para ler o atributo data-text */
            width: 70px;
            text-align: center;
            padding: 5px;
            border-radius: 5px;
            background-color: #fff;
            transform: rotate(-90deg);
            left: 15px;
        }

        .botao::before {
            position: absolute;
            content: ".";
            width: 10px;
            background-color: white;
            color: white;
            top: -15px;
            left: 40px;
            transform: rotate(45deg);
        }

        input#toggle {
            display: none;
        }

        input#toggle ~ .menu {
            display: block;
        }

        input#toggle:checked ~ .lamp1 {
            position: absolute;
            background: #fdb327;
            box-shadow: 0 0 200px 50px #FFF, 0 0 10px 1px #ff6600, 0 0 500px 100px #ffe066, 0 0 500px 250px #ffcc00, 0 0 200px 230px #ff6600, 0 0 10px 999px #000;
            transition: .1s;
        }

        input#toggle:checked ~ .lamp2 {
            background: #fdb327;
            transition: .1s;
        }

        input#toggle:checked ~ .resist-a {
            background: #fff;
            box-shadow: 0 0 20px 1px white;
        }

        input#toggle:checked ~ .resist-b {
            background: #fff;
            box-shadow: 0 0 20px 3px white;
            animation: fio 0.2s infinite;
        }



        @keyframes interruptor {
            from {
                top: -14rem; /* Alterado de -8rem */
            }
            to {
                top: -12rem; /* Alterado de -6rem */
            }
        }

        @keyframes fio {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.2);
            }
        }

        .lamp1 {
            position: absolute;
            width: 100px;
            height: 100px;
            background: grey;
            top: 15px;
            border-radius: 100% 95% 100% 30%;
            box-sizing: border-box;
            border-left: 0px solid #fdb327;
            border-right: 0px solid #fdb327;
            margin-left: -35.5px;
            margin-top: 20px;
            transform: rotate(135deg);
        }

        .lamp1-brilho::before {
            content: "";
            position: absolute;
            width: 27px;
            height: 60px;
            border-left: 10px solid rgba(255, 255, 255, .40);
            border-radius: 100%;
            margin: -5px 37px;
            transform: rotate(100deg);
        }

        .resist-a {
            position: absolute;
            width: 2px;
            height: 70px;
            background: darkgrey;
            box-sizing: border-box;
        }

        .resist1 {
            margin-left: 5px;
            margin-top: 10px;
            transform: rotate(10deg);
        }

        .resist2 {
            margin-left: 25px;
            margin-top: 10px;
            transform: rotate(-10deg);
        }

        .resist-b {
            position: absolute;
            width: 16px;
            height: 1px;
            background: darkgrey;
            box-sizing: border-box;
            margin-top: 75px;
        }

        .resist3 {
            margin-left: 0px;
            transform: rotate(-15deg);
        }

        .resist4 {
            margin-left: 16px;
            transform: rotate(15deg);
        }

        .lamp2 {
            position: absolute;
            width: 35px;
            height: 40px;
            background: grey;
            border-radius: 20%;
            box-sizing: border-box;
            margin-left: -2px;
            margin-top: 2%;
        }

        .lamp3 {
            position: absolute;
            width: 30px;
            height: 20px;
            background: #383838;
            top: -10px;
        }
        
        /* Estilos para o player de vídeo */
        #videoContainer {
            display: none; /* Começa escondido */
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000;
            z-index: 10000; /* Garante que fique por cima de tudo */
        }

        #videoPlayer {
            width: 100%;
            height: 100%;
        }

        /* --- NOVO ESTILO (para a transição de brilho) --- */
        #transitionOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #fff; /* A cor do "brilho" */
            opacity: 0;
            pointer-events: none; /* Permite clicar através dele */
            z-index: 99999; /* Garante que fique no topo */
            transition: opacity 0.8s ease-in-out; /* Duração da transição */
        }

        /* --- NOVO: Estilos para orientação em modo retrato no celular --- */
        #rotate-device-overlay {
            display: none; /* Escondido por padrão */
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000;
            color: #fff;
            z-index: 100000;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        @media (max-width: 932px) and (orientation: portrait) {
            #rotate-device-overlay {
                display: flex; /* Mostra o aviso em modo retrato */
            }
        }

        /* --- NOVO: Estilos para o seletor de vídeo --- */
        #video-selector {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
        }

        #video-selector.hidden {
            display: none;
        }

        .video-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgba(255, 80, 80, 0.8);
            border: 2px solid white;
            color: white;
            font-family: 'Patrick Hand', cursive;
            font-size: 1.2rem;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s; /* NOVO: para suavizar a seleção */
        }

        /* NOVO: Estilo para o botão selecionado */
        .video-btn.selected {
            background-color: #e28686; /* Cor mais viva */
            transform: scale(1.1); /* Um pouco maior */
        }

        /* --- NOVO: Estilos para o botão de tela cheia --- */
        #fullscreen-btn {
            display: none; /* Escondido por padrão, mostrado via media query */
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 35px;  /* Alterado para ser menor */
            height: 35px; /* Alterado para ser menor */
            background-color: rgba(255, 80, 80, 0.8);
            border: 2px solid white;
            border-radius: 50%;
            z-index: 1001; /* Acima do seletor de vídeo */
            cursor: pointer;
            align-items: center;
            justify-content: center;
        }

        /* NOVO: Ajusta o tamanho do ícone SVG dentro do botão */
        #fullscreen-btn svg {
            width: 18px;
            height: 18px;
        }

        #fullscreen-btn.hidden {
            display: none !important;
        }

        /* Mostra o botão apenas em telas de celular */
        @media (max-width: 932px) {
            #fullscreen-btn {
                display: flex;
            }
        }

        /* --- NOVO: Estilos para o overlay de forçar tela cheia --- */
        #force-fullscreen-overlay {
            display: none; /* Escondido por padrão */
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.85); /* Fundo preto semitransparente */
            z-index: 1000; /* Abaixo do botão de tela cheia (que é 1001) */
            color: white;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
            font-size: 1.3rem;
        }

    </style>
</head>
<body>

    <!-- Seu HTML original da lâmpada -->
    <div class="container" id="lampContainer">
        <input type="checkbox" id="toggle">
        
        <!-- Alteração: O .interruptor é um div, e o .botao é a label "for" -->
        <div class="interruptor">
            <label class="botao" for="toggle" data-text="Puxe-me!">
                <!-- O conteúdo do botão agora é gerado por ::after e ::before -->
            </label>
        </div>

        <div class="lamp1">
            <div class="lamp1-brilho">
            </div>
        </div>
        <div class="lamp2">
        </div>
        <div class="resist-a resist1">
        </div>
        <div class="resist-a resist2">
        </div>
        <div class="resist-b resist3">
        </div>
        <div class="resist-b resist4">
        </div>
        <div class="lamp3">
        </div>
        <div class="thing">
        </div>
    </div>

    <!-- Container do Vídeo (adicionado) -->
    <div id="videoContainer">
        <video id="videoPlayer">
            <!-- O 'src' será definido via JavaScript -->
        </video>
    </div>

    <!-- Elemento da Transição (adicionado) -->
    <div id="transitionOverlay"></div>

    <!-- NOVO: Overlay para pedir rotação do dispositivo -->
    <div id="rotate-device-overlay">
        <h1>Por favor, gire seu dispositivo</h1>
        <p>Esta experiência foi projetada para visualização em modo paisagem (horizontal).</p>
    </div>

    <!-- NOVO: Seletor de vídeo -->
    <div id="video-selector" class="hidden">
        <button class="video-btn" data-index="0">1</button>
        <button class="video-btn" data-index="1">2</button>
        <button class="video-btn" data-index="2">3</button>
        <button class="video-btn" data-index="3">4</button>
        <button class="video-btn" data-index="4">5</button>
    </div>

    <!-- NOVO: Botão de tela cheia para celular -->
    <button id="fullscreen-btn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15 3H21V9" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M9 21H3V15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M21 3L14 10" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M3 21L10 14" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </button>

    <!-- NOVO: Overlay para incentivar a tela cheia em celulares -->
    <div id="force-fullscreen-overlay">
        <p>Para uma melhor experiência, pressione o botão de tela cheia!</p>
    </div>

    <script>
        // --- Início da Lógica de JavaScript ---

        const videoList = [
            'videos/video1.mp4',
            'videos/video2.mp4',
            'videos/video3.mp4',
            'videos/video4.mp4',
            'videos/video5.mp4'
        ];

        let currentVideoIndex = 0;
        // --- NOVO: Rastreia vídeos já tocados e se o seletor deve aparecer ---
        const playedVideos = new Set();
        let allVideosPlayed = false;
        

        // --- NOVO: Variáveis para detectar arrasto ---
        let isDragging = false;
        let dragStartY = 0;
        let dragDistance = 0;

        // Pegando os elementos do DOM
        const toggleCheckbox = document.getElementById('toggle');
        const lampContainer = document.getElementById('lampContainer');
        const videoContainer = document.getElementById('videoContainer');
        const videoPlayer = document.getElementById('videoPlayer');
        const interruptor = document.querySelector('.interruptor'); // NOVO
        
        // --- NOVOS ELEMENTOS ---
        const transitionOverlay = document.getElementById('transitionOverlay');
        const pullCordButton = document.querySelector('.botao'); // Pegando o botão
        const videoSelector = document.getElementById('video-selector'); // NOVO
        const fullscreenBtn = document.getElementById('fullscreen-btn'); // NOVO
        const forceFullscreenOverlay = document.getElementById('force-fullscreen-overlay'); // NOVO

        // --- NOVO: Remove o comportamento padrão do label ---
        pullCordButton.addEventListener('click', (e) => {
            e.preventDefault();
            return false;
        });

        // --- NOVO: Detecta o início do arrasto ---
        pullCordButton.addEventListener('mousedown', (e) => {
            e.preventDefault();
            isDragging = true;
            dragStartY = e.clientY;
            dragDistance = 0;
            interruptor.style.animation = 'none'; // Remove animação anterior
        });

        // --- NOVO: Detecta o movimento durante o arrasto ---
        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                dragDistance = e.clientY - dragStartY;
                
                // Aplica transformação visual ao interruptor baseado no arrasto
                // Quanto mais arrasta, mais o interruptor "se move"
                const moveAmount = Math.min(dragDistance, 30); // Limita a 30px
                interruptor.style.transform = `translateY(${moveAmount}px)`;
            }
        });

        // --- NOVO: Detecta o fim do arrasto ---
        document.addEventListener('mouseup', () => {
            if (isDragging && dragDistance > 20) { // Só ativa se arrastar mais de 20px
                toggleCheckbox.checked = true;
                toggleCheckbox.dispatchEvent(new Event('change'));
            }
            
            // Volta o interruptor à posição original
            interruptor.style.transform = 'translateY(0px)';
            isDragging = false;
            dragDistance = 0;
        });
        
        // --- NOVO: Adiciona eventos de toque para funcionar no celular ---
        pullCordButton.addEventListener('touchstart', (e) => {
            e.preventDefault();
            isDragging = true;
            dragStartY = e.touches[0].clientY; // Pega a posição do primeiro toque
            dragDistance = 0;
            interruptor.style.animation = 'none';
        }, { passive: false });

        document.addEventListener('touchmove', (e) => {
            if (isDragging) {
                dragDistance = e.touches[0].clientY - dragStartY;
                const moveAmount = Math.min(dragDistance, 30);
                interruptor.style.transform = `translateY(${moveAmount}px)`;
            }
        });

        document.addEventListener('touchend', () => {
            if (isDragging && dragDistance > 20) {
                toggleCheckbox.checked = true;
                toggleCheckbox.dispatchEvent(new Event('change'));
            }
            interruptor.style.transform = 'translateY(0px)';
            isDragging = false;
            dragDistance = 0;
        });

        // 1. Ouve a mudança no checkbox (quando a lâmpada é "puxada")
        toggleCheckbox.addEventListener('change', () => {
            if (toggleCheckbox.checked) {
                // A lâmpada ACENDEU
                
                // 1. Inicia a transição de "brilho" (fade-in to white)
                transitionOverlay.style.pointerEvents = 'auto'; // Bloqueia cliques
                transitionOverlay.style.opacity = '1';

                // --- NOVO: Esconde o seletor durante a transição/vídeo ---
                videoSelector.classList.add('hidden');
                fullscreenBtn.classList.add('hidden'); // NOVO
                forceFullscreenOverlay.style.display = 'none'; // NOVO

                // 2. Espera a transição (0.8s) acabar
                setTimeout(() => {
                    // 3. No PICO do brilho (tela branca), troca o conteúdo
                    lampContainer.style.display = 'none';
                    videoContainer.style.display = 'block';
                    
                    // 4. Define o vídeo e TOCA (mas ainda está coberto)
                    videoPlayer.src = videoList[currentVideoIndex];
                    videoPlayer.play();

                    // 5. Inicia o "fade-out" para revelar o vídeo
                    transitionOverlay.style.opacity = '0';
                    
                    // 6. Espera o fade-out (0.8s) acabar
                    setTimeout(() => {
                        transitionOverlay.style.pointerEvents = 'none'; // Libera cliques
                    }, 800); // Mesmo tempo da transição

                }, 800); // Mesmo tempo da transição
            }
        });

        // 2. Ouve quando o vídeo TERMINA
        videoPlayer.addEventListener('ended', () => {
            // --- NOVO: Adiciona o vídeo que acabou de tocar ao set de tocados ---
            playedVideos.add(currentVideoIndex);
            if (playedVideos.size === videoList.length) {
                allVideosPlayed = true;
            }

            // Esconde o vídeo e mostra a lâmpada
            videoContainer.style.display = 'none';
            lampContainer.style.display = 'block';
            // NOVO: Mostra o botão apenas se NÃO estiver em tela cheia
            if (!document.fullscreenElement) {
                showControlsForMobile(); // NOVO
            }
            
            // "Apaga" a lâmpada (desmarca o checkbox)
            toggleCheckbox.checked = false;

            // --- LÓGICA ALTERADA: Prepara o próximo vídeo ---
            if (!allVideosPlayed) {
                // Se ainda não tocou todos, avança para o próximo
                currentVideoIndex = (currentVideoIndex + 1) % videoList.length;
            }
            // Se já tocou todos, `currentVideoIndex` permanece o que foi selecionado pelo botão.
            // Se nenhum foi selecionado, ele repetirá o último.

            // --- NOVO: Mostra o seletor se todos os vídeos já foram tocados ---
            if (allVideosPlayed) {
                videoSelector.classList.remove('hidden');
            }

            // Muda o texto do botão
            pullCordButton.dataset.text = 'Puxe-me novamente!';
        });

        // --- NOVO: Lógica para os botões de seleção de vídeo ---
        videoSelector.addEventListener('click', (e) => {
            if (e.target.classList.contains('video-btn')) {
                // --- LÓGICA ALTERADA para feedback visual ---
                // 1. Remove a classe 'selected' de todos os botões
                const allButtons = videoSelector.querySelectorAll('.video-btn');
                allButtons.forEach(btn => btn.classList.remove('selected'));

                // 2. Adiciona a classe 'selected' apenas ao botão clicado
                e.target.classList.add('selected');

                // 3. Define o índice do vídeo a ser tocado
                const selectedIndex = parseInt(e.target.dataset.index, 10);
                currentVideoIndex = selectedIndex;
            }
        });

// --- NOVO: Lógica para o botão de tela cheia ---
        fullscreenBtn.addEventListener('click', async () => {
            // Esconde o botão assim que for clicado
            // fullscreenBtn.classList.add('hidden'); // REMOVIDO: O evento fullscreenchange cuidará disso

            try {
                if (document.documentElement.requestFullscreen) {
                    await document.documentElement.requestFullscreen();
                }
                // Tenta travar a orientação em paisagem, ideal para os vídeos
                if (screen.orientation?.lock) { // Usando optional chaining para mais segurança
                    await screen.orientation.lock('landscape-primary');
                }
            } catch (err) {
                // O erro é esperado se o usuário negar a permissão ou o navegador não suportar
                console.error("Erro ao tentar entrar em tela cheia:", err);
                // Se der erro, mostra o botão novamente
                showControlsForMobile();
            }
        });

        // --- NOVO: Lógica para reexibir o botão ao sair da tela cheia ---
        document.addEventListener('fullscreenchange', () => {
            if (document.fullscreenElement) {
                // Entrou em tela cheia: esconde o overlay e o botão
                forceFullscreenOverlay.style.display = 'none';
                fullscreenBtn.classList.add('hidden');
            } else {
                // Saiu da tela cheia: mostra os controles (se for celular)
                showControlsForMobile();
            }
        });

        // --- NOVA FUNÇÃO: Controla a exibição dos botões e overlay no celular ---
        function showControlsForMobile() {
            // Verifica se a largura da tela corresponde à de um celular (mesma regra do CSS)
            if (window.matchMedia("(max-width: 932px)").matches) {
                forceFullscreenOverlay.style.display = 'flex';
                fullscreenBtn.classList.remove('hidden');
            } else {
                forceFullscreenOverlay.style.display = 'none';
            }
        }

        // --- NOVO: Executa a verificação quando a página carrega ---
        window.addEventListener('load', showControlsForMobile);
        window.addEventListener('resize', showControlsForMobile);

        // --- Fim da Lógica de JavaScript ---
    </script>

</body>
</html>